{% extends 'base.html' %}

{% block title %}
<title>Products</title>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="row">

    <div class="col-md-3">
      <div class="card p-3 shadow-sm">
        <h6 class="fw-bold">üîç Search & Filter</h6>

  
        <form method="GET" action="{% url 'products' %}" class="mb-3">
          <input type="text" name="q" class="form-control form-control-sm mb-2" 
                 placeholder="Search products..." value="{{ request.GET.q }}">
          <button type="submit" class="btn btn-dark btn-sm w-100">Search</button>
        </form>
        

        <form method="GET" action="{% url 'products' %}">
          <select name="filter_by" class="form-select form-select-sm mb-2">
            <option value="">Filter by...</option>
            <option value="name" {% if request.GET.filter_by == "name" %}selected{% endif %}>Name</option>
            <option value="sku" {% if request.GET.filter_by == "sku" %}selected{% endif %}>SKU</option>
            <option value="category" {% if request.GET.filter_by == "category" %}selected{% endif %}>Category</option>
            <option value="low_stock" {% if request.GET.filter_by == "low_stock" %}selected{% endif %}>Low Stock</option>
            <option value="out_of_stock" {% if request.GET.filter_by == "out_of_stock" %}selected{% endif %}>Out of Stock</option>
          </select>
          <button type="submit" class="btn btn-dark btn-sm w-100">
            <i class="bi bi-sliders2-vertical"></i> Filter by
          </button>
        </form>
      </div>
    </div>

    <!-- Product List -->
    <div class="col-md-9">
      <div class="d-flex justify-content-end mb-3">
        <a href="{% url 'add_product' %}" class="btn btn-dark btn-sm px-3 py-1 rounded-pill">
          + Add Product
        </a>
      </div>
      
      <div class="d-flex flex-wrap justify-content-center gap-3">
        {% for product in products %}
          <a href="{% url 'productdetails' product_id=product.id %}" class="text-decoration-none" style="color: black;">
            <div class="card" 
                 style="width: 14rem; border-radius: 0; border: 2px solid #ddd; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.2);">
              <img src="{{ product.thumbnail }}" class="card-img-top object-fit-cover" 
                   alt="..." style="height: 150px; border-radius: 0;"> 
              <div class="card-body">
                <h6 class="card-title">{{ product.name }}</h6>
                <p class="card-text" style="font-size: 0.85rem;">{{ product.description }}</p>
                
                
                <span class="badge 
                  {% if product.status == 'in_stock' %} bg-success 
                  {% elif product.status == 'low_stock' %} bg-warning 
                  {% elif product.status == 'out_of_stock' %} bg-danger 
                  {% endif %}">
                  {{ product.get_status_display }}
                </span>
      
              </div>
            </div>
          </a>
        {% endfor %}
      </div>
      </div>      
      </div>
    </div>


{% endblock %}
